---
import ArticlePage from "@pages/articles/[slug].astro";
import { type CollectionEntry, getCollection } from "astro:content";

interface Props {
  entry: CollectionEntry<"blogs">;
  language: string;
}

let { entry, language } = Astro.props;
if (!language) {
  language = "th";
}

export async function getStaticPaths() {
  let blogEntries = await getCollection("blogs", ({ data }) => {
    if (import.meta.env.PROD) {
      return data.draft !== true;
    } else {
      return true;
    }
  });

  blogEntries = blogEntries.filter(
    (post) => post.data.show === undefined || post.data.show,
  );

  return blogEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}
---

<ArticlePage {language} {entry} />
